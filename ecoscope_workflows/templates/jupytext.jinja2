{% import 'jupytext-macros.jinja' as macros %}
# ruff: noqa: E402

# %% [markdown]
# # {{ spec.name.title().replace("_", " ") }}
# TODO: top level description

# %% [markdown]
# ## Imports

import os
{% if spec.requires_map_exra_imports -%}
from functools import partial
{% endif -%}
{% for t in spec.workflow -%}
{{ t.known_task.importable_reference.statement }}
{% if loop.last %}
{% endif -%}
{% endfor -%}
{%- for t in spec.workflow -%}
{{ macros.handle_task(t) }}
{% endfor -%}
