# ecoscope-workflows

This repository contains 7 distinct Python packages. Of those, the two contained under `src/` represent the core logic developed in this repo:

```
src
â”œâ”€â”€ ecoscope-workflows-core
â””â”€â”€ ecoscope-workflows-ext-ecoscope
```

- [`ecoscope-workflows-core`](./src/ecoscope-workflows-core/README.md) is a code generator that provides a specification for defining workflows (i.e. DAGs) of Python callables (known as `@task`s) in YAML, as well as a CLI for compiling these YAML DAG definitions into installable packages. The package generated by this compilation process provides both REST API and CLI entrypoints for running the specified workflow.
- [`ecoscope-workflows-ext-ecoscope`](./src/ecoscope-workflows-ext-ecoscope/README.md) is a task extension package which, when installed, registers additional `@task`s with the core compiler that wrap logic provided by [`ecoscope`](https://github.com/wildlife-dynamics/ecoscope).

The remaining 5 packages in this repo are examples of the types of workflow packages which can be generated by this framework. The structure of each subdirectory in the `examples` directory adheres to the following format:

```
examples
â””â”€â”€ <EXAMPLE-NAME>
    â”œâ”€â”€ ecoscope-workflows-<EXAMPLE-NAME>-workflow
    â”œâ”€â”€ spec.yaml
    â””â”€â”€ test-cases.yaml
```
where:

- `EXAMPLE-NAME` is the workflow author's selected name for this example
- `spec.yaml` is the specification defining
- `test-cases.yaml` is a user
- `ecoscope-workflows-<EXAMPLE-NAME>-workflow` is the dynamically generated package. _**Note**: All code in this subdirectory is machine-generated. It should not be manually edited._


## Development



## Why pixi?

| feature            | pip | poetry | conda | mamba | micromamba | pixi.sh |
| ---------------    | --- | ------ | ----- | ----- | ---------- | ------- |
| python deps        |  âœ… |   âœ…   | âœ…    | âœ…    | âœ…         |  âœ…     |
| conda-compatible   |  âŒ |   âŒ   | âœ…    | âœ…    | âœ…         |  âœ…     |
| native lockfiles   |  âŒ |   âœ…   | âŒ    | âŒ    | âŒ         |  âœ…     |
| performance        |  âœ… |   âœ…   | âŒ    | ğŸ¤·    | ğŸ¤·         |  ğŸ”¥     |


## Examples

To recompile all examples in the `examples/` directory

1. [Install pixi](https://pixi.sh/latest/#installation)
2. From the repo root, run:
    ```console
    $ pixi run --manifest-path pixi.toml recompile-all
    ```
